"use strict";

module.exports = function (compiler, cache) {
  return function (source, filename) {
    var hasCompiler = compiler && typeof compiler === "function",
        hasInCache = cache[filename] !== undefined;

    var result = source;

    if (hasCompiler && hasInCache) {
      result = cache[filename];
    } else if (hasCompiler) {
      result = cache[filename] = compiler(source, filename);
    }

    return result;
  };
};